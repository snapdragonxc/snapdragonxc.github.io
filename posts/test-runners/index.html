<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"  lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1"/>


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">


<title>Test Runners | CODING BLOG</title>


<link rel="stylesheet" href="/css/style.css"/><link rel='stylesheet' href='https://snapdragonxc.github.io/css/custom.css'><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
</head>
<body>
<script type="text/javascript">
  var _paq = _paq || [];
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="\/\/matomo.example.com\/";
    _paq.push(['setTrackerUrl', u+'piwik.php']);
    _paq.push(['setSiteId', '1']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<noscript>
  <img src="//matomo.example.com/piwik.php?idsite=1&amp;rec=1" style="border:0" alt="" />
</noscript>



<div class="row">
    <header class="header">
  <div class="header__wrap">
    <div class="row">
    <div class="header__left xs-col-span-12 sm-col-span-6">
      <a class="header__title-link" href="https://snapdragonxc.github.io/"><h1 class="header__title">CODING BLOG</h1></a>
    </div>

    <nav class="header__right xs-col-span-12 sm-col-span-6"><a class="header__social-link" aria-label="author"
          href='/about'rel='noopener'>
<svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M21,21V17.5 c0-2.76-4-5-9-5s-9,2.24-9,5v3.5"/>
    <path d="M12,1
    A
    3.5, 3.5,
    0,
    0,
    1,
    12.0, 12.0,
    M12,1
    A
    3.5, 3.5,
    0,
    0,
    0,
    12.0, 12.0,
    "/>
    
  </svg>
</a><a class="header__social-link" aria-label="email"
          href='mailto:snapdragonxc@gmail.com'target='_blank'rel='noopener'>
<svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
    <polyline points="22,6 12,13 2,6"/>
    
  </svg>
</a><a class="header__social-link" aria-label="github"
          href='https://github.com/snapdragonxc'target='_blank'rel='noopener'>
<svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/>
    
  </svg>
</a></nav>
    <div class="clear-fix"></div>
    </div>
  </div>
</header>

</div>

<div class="wrapper wrapper--small">
  <div class="row">
    <article class="single">
      <div class="single__wrap">
        <div class="single-article__heading single-article__heading--single">
          <h2 class="single-article__title">
            <span class="single-article__title--main">Test Runners</span>
            <span class="single-article__title--sub">Creating your own from scratch</span>
          </h2>
          <h4 class="single-article__date">September 11, 2018</h4>
        </div>

        <div class="single__content">
          <p>Writing your own Test Runner will give you greater insight and confidence when using one of the professional frameworks such as Jasmine or Jest. In this post a simple Test Runner will be developed and applied to a basic Maths library.</p>

<p></p>

<p>When you write code you naturally test it against something that you would like it to do without thought. In Mathematical coding, for example, you would check any maths function that you code against a set of tables describing the function. Lets see how we would do this using some basic maths functions and from there create our own test runner library.</p>

<p>Suppose we have a function that adds together two numbers. We write this function as follows and export it as &ldquo;add.js&rdquo; for use throughout any project that might require it:</p>

<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="c1">// add.js
</span><span class="c1"></span><span class="kd">function</span> <span class="nx">add</span><span class="p">(</span><span class="nx">num1</span><span class="p">,</span> <span class="nx">num2</span><span class="p">){</span>
  <span class="k">return</span> <span class="nx">num1</span> <span class="o">+</span> <span class="nx">num2</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">add</span><span class="p">;</span>
</code></pre></div>

<p>Before using it, we would like to test that our code is actually performing an addition by console logging the output of a particular test case. We put this into a file called test.spec.js to distinguish it from our add.js code:</p>

<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="c1">// test.spec.js
</span><span class="c1"></span><span class="kd">let</span> <span class="nx">add</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./add.js&#39;</span><span class="p">)</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;3 + 5 = 8,&#39;</span><span class="p">,</span> <span class="nx">add</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">));</span>
</code></pre></div>

<p>Then in the terminal:</p>

<div class="highlight"><pre class="chroma"><code class="language-shell-script" data-lang="shell-script">$ node test.spec
3 + 5 = 8, 8</code></pre></div>

<p>Which confirms that our add function is indeed working.</p>

<p>As it stands though, this is meaningless to anyone who does not know it is an addition function test. Therefore, lets go one step further and make our console output something usefull with a test title and a &ldquo;pass&rdquo; or &ldquo;fail&rdquo; statement, depending on the outcome of the test. The test.spec.js file now becomes:</p>

<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="c1">// test.spec.js
</span><span class="c1"></span><span class="kd">let</span> <span class="nx">add</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./add.js&#39;</span><span class="p">);</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;The add function&#39;</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">expected</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span>
<span class="kd">let</span> <span class="nx">actual</span> <span class="o">=</span> <span class="nx">add</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
<span class="k">if</span><span class="p">(</span><span class="nx">expected</span> <span class="o">===</span> <span class="nx">actual</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;pass&#39;</span><span class="p">);</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;fail&#39;</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p>Then in the terminal we have a more usefull output:</p>

<div class="highlight"><pre class="chroma"><code class="language-shell-script" data-lang="shell-script">$ node test.spec
The add function
pass</code></pre></div>

<p>Expanding our maths code, suppose we now want to have a multiply function:</p>

<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="c1">// multiple.js
</span><span class="c1"></span><span class="kd">function</span> <span class="nx">multiply</span><span class="p">(</span><span class="nx">num1</span><span class="p">,</span> <span class="nx">num2</span><span class="p">){</span>
  <span class="k">return</span> <span class="nx">num1</span> <span class="o">*</span> <span class="nx">num2</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">multiply</span><span class="p">;</span>
</code></pre></div>

<p>Naturally, we now want to include this in our test spec file as well, which we update accordingly:</p>

<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="c1">// test.spec.js
</span><span class="c1"></span><span class="kd">let</span> <span class="nx">add</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./add.js&#39;</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">multiply</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./multiply.js&#39;</span><span class="p">);</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;The add function&#39;</span><span class="p">)</span>
<span class="kd">let</span> <span class="nx">expected</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span>
<span class="kd">let</span> <span class="nx">actual</span> <span class="o">=</span> <span class="nx">add</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
<span class="k">if</span><span class="p">(</span><span class="nx">expected</span> <span class="o">===</span> <span class="nx">actual</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;pass&#39;</span><span class="p">);</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;fail&#39;</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;The multiply function&#39;</span><span class="p">);</span>
<span class="nx">expected</span> <span class="o">=</span> <span class="mi">12</span><span class="p">;</span>
<span class="nx">actual</span> <span class="o">=</span> <span class="nx">multiply</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
<span class="k">if</span><span class="p">(</span><span class="nx">expected</span> <span class="o">===</span> <span class="nx">actual</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;pass&#39;</span><span class="p">);</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;fail&#39;</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p>Running the new test spec in the terminal we get:</p>

<div class="highlight"><pre class="chroma"><code class="language-shell-script" data-lang="shell-script">$ node test.spec
The add function
pass
The multiply function
pass</code></pre></div>

<p>and with that we have our test.spec.js.</p>

<p>Whilst there is nothing wrong with our code, there is a lot of uneccesary repeated code, which just adds to the clutter. Lets now create a library called &lsquo;runner.js&rsquo; to refactor this.</p>

<p>Refactoring first the If statement, we create a function called &lsquo;verify&rsquo; that checks that expected = actual and console logs the result:</p>

<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="c1">// runner.js
</span><span class="c1"></span><span class="kd">function</span> <span class="nx">verify</span><span class="p">(</span><span class="nx">expected</span><span class="p">,</span> <span class="nx">actual</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">expected</span> <span class="o">===</span> <span class="nx">actual</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;pass&#39;</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;fail&#39;</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="nx">module</span><span class="p">.</span><span class="k">export</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">expect</span> <span class="p">};</span>
</code></pre></div>

<p>The test.sec.js now simplifies to:</p>

<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="c1">// test.spec.js
</span><span class="c1"></span><span class="kd">let</span> <span class="nx">add</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./add.js&#39;</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">multiply</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./multiply.js&#39;</span><span class="p">);</span>
<span class="kd">let</span> <span class="p">{</span> <span class="nx">verify</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./runner.js&#39;</span><span class="p">)</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;The add function&#39;</span><span class="p">)</span>
<span class="kd">let</span> <span class="nx">expected</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span>
<span class="kd">let</span> <span class="nx">actual</span> <span class="o">=</span> <span class="nx">add</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
<span class="nx">verify</span><span class="p">(</span><span class="nx">expected</span><span class="p">,</span> <span class="nx">actual</span><span class="p">);</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;The multiply function&#39;</span><span class="p">);</span>
<span class="nx">expected</span> <span class="o">=</span> <span class="mi">12</span><span class="p">;</span>
<span class="nx">actual</span> <span class="o">=</span> <span class="nx">multiply</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
<span class="nx">verify</span><span class="p">(</span><span class="nx">expected</span><span class="p">,</span> <span class="nx">actual</span><span class="p">);</span>
</code></pre></div>

<p>Note that the console output has not been changed during this refactor and still ouputs as previously.</p>

<p>Although a considerable improvement, we can still refactor further with a function to encapsulate each test case. Writing such a function, called &ldquo;test&rdquo;, the runner.js file becomes:</p>

<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="c1">// runner.js
</span><span class="c1"></span><span class="kd">function</span> <span class="nx">verify</span><span class="p">(</span><span class="nx">expected</span><span class="p">,</span> <span class="nx">actual</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">expected</span> <span class="o">===</span> <span class="nx">actual</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;pass&#39;</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;fail&#39;</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">test</span><span class="p">(</span><span class="nx">title</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">title</span><span class="p">);</span>
  <span class="nx">callback</span><span class="p">();</span>
<span class="p">}</span>
<span class="nx">module</span><span class="p">.</span><span class="k">export</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">expect</span><span class="p">,</span> <span class="nx">test</span> <span class="p">}</span>
</code></pre></div>

<p>The test.spec.js file can now be refactored to:</p>

<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="c1">// test.spec.js
</span><span class="c1"></span><span class="kd">let</span> <span class="nx">add</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./add.js&#39;</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">multiply</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./multiply.js&#39;</span><span class="p">);</span>
<span class="kd">let</span> <span class="p">{</span> <span class="nx">test</span><span class="p">,</span> <span class="nx">verify</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./runner.js&#39;</span><span class="p">);</span>

<span class="nx">test</span><span class="p">(</span><span class="s1">&#39;The add function&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="nx">expected</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span>
  <span class="kd">let</span> <span class="nx">actual</span> <span class="o">=</span> <span class="nx">add</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
  <span class="nx">verify</span><span class="p">(</span><span class="nx">expected</span><span class="p">,</span> <span class="nx">actual</span><span class="p">);</span>
<span class="p">});</span>

<span class="nx">test</span><span class="p">(</span><span class="s1">&#39;The multiply function&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="nx">expected</span> <span class="o">=</span> <span class="mi">12</span><span class="p">;</span>
  <span class="kd">let</span> <span class="nx">actual</span> <span class="o">=</span> <span class="nx">multiply</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
  <span class="nx">verify</span><span class="p">(</span><span class="nx">expected</span><span class="p">,</span> <span class="nx">actual</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div>

<p>Sitting back and looking at what we have just done, you can see that we have now created our very own test runner library from scratch. Whilst a long way away from a professional library, it does give a usefull insight into the workings of such a library.</p>
        </div>
        
      </div>
      </article>
    </div>

  <div class="row">
    <div class="return">
        <a class="btn" href="javascript:void(0);" onclick="goBack()">
          <span class="btn__icon"><i class="fa fa-chevron-circle-left"></i></span>
          BACK
        </a>
    </div>
  </div>

</div>


<script>
  function goBack() {
      window.history.back();
  }
</script>

<footer class="footer">
  <div class="footer__wrap">
    
    <p class="footer__link-wrap">
      A <a class="footer__link" href="https://gohugo.io/">Hugo static site</a> built with the
      <a class="footer__link" href="https://github.com/snapdragonxc/galerie">Galerie theme</a>.
    </p>
    
    <p class="footer__text">&copy; <a href="https://github.com/snapdragonxc">Snapdragonxc</a> 2018</p>
  </div>
</footer>

</body>
</html>

